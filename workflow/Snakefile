from snakemake.utils import min_version

min_version("7.5.0")


configfile: "config/config.yaml"


if config["mosaicatcher_pipeline"] is False:

    docker_container = "docker://weber8thomas/ashleys-qc-pipeline:{version}".format(
        version=str(config["version"])
    )

    containerized: docker_container


include: "rules/common.smk"


include: "rules/rules.smk"


include: "rules/gc.smk"


include: "rules/count.smk"


# wildcard_constraints:
#     cell="\d$",

if config["mosaicatcher_pipeline"] is False:

    include: "rules/examples.smk"


if config["dl_external_files"] is True:

    if config["mosaicatcher_pipeline"] is False:

        if config["reference"] in ["hg19", "hg38", "T2T"]:

            if config["reference"] == "hg19":

                rule all:
                    input:
                        rules.download_hg19_reference.output,


            elif config["reference"] == "hg38":

                rule all:
                    input:
                        rules.download_hg38_reference.output,


            elif config["reference"] == "T2T":

                rule all:
                    input:
                        rules.download_T2T_reference.output,


        else:
            sys.exit(
                "You provide a wrong/not supported reference assembly: {}. Supported assemblies : hg19, hg38, T2T".format(
                    config["reference"]
                )
            )


else:

    rule all:
        input:
            get_final_output(),
